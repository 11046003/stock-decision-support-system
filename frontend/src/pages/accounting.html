<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <style>

      @import url(//fonts.googleapis.com/earlyaccess/notosanstc.css);
        * {
          font-family: 'Poppins','Helvetica', 'Arial', 'Noto Sans TC', '黑體-繁','微軟正黑體', sans-serif !important;
        }

        .nav-link{
          color: #C0C2C6;
          font-size: 15px !important;
        }

        .nav-link:hover{
          color: #ffffff !important;
        }

        #btnb:hover{
          background-color: rgba(1 , 198, 183, 80%);
        }

        .kv{
          height: 100vh;
        }
        .larger-text {
          font-size: 3em; /* 或者使用px, %, 等等來設置你想要的大小 */
        }
        .btn:hover{

        }

        .account-form{
            margin-left: 50px;
        }
        /* 自定義表單樣式 */
        .account-form-container {
       margin-top: 20px;
    margin-left: 20px;
    padding: 20px; /* 添加内边距 */
    background-color: #fff; /* 白色背景 */
    border-radius: 8px; /* 圓角 */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* 添加陰影效果 */
    width: 500px;
    height: 700px;
         }

        .totalamounttitle{
          margin-top: 20px;
    margin-left: 20px;
    font-size: 24px;
    color: #333; /* 更改文字顏色 */
        }

        .totalamount{
          background-color: #f8f9fa; /* 更改背景色 */
    width: 300px;
    height: 100px;
    margin-top: 10px; /* 調整上方距離 */
    margin-left: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 36px;
    color: #333; /* 更改文字顏色 */
    border-radius: 8px; /* 圓角 */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* 添加陰影效果 */
        }
        /* 以下為進度條設定 */
        .progress-container {
            position: absolute; /* 將定位方式改為絕對定位 */
            margin-top: 20px;
            margin-right: 20px;
            width: 500px;
            height: 100px;
            right: 0; /* 距離父元素右側的距離 */
            top: 13%; /* 距離父元素頂部的距離 */
            transform: translateY(-50%);
        }

        .progress-bar {
            height: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: transparent; /* 將初始顏色設置為透明 */
            transition: width 0.3s ease-in-out, background-color 0.3s ease-in-out; /* 添加背景顏色的過渡效果 */
        }

        .progress-button {
            display: block;
            margin-bottom: 15px; /* 調整與其他元素的間距 */
            }

        .progress-label {
            position: absolute;
            font-size: 12px; /* 調整字體大小 */
            }

        #currentTotal {
            bottom: 0;
            left: 0;
        }

        #limitAmount {
            bottom: 0;
            right: 0;
        }
        /* 交易紀錄顯示 */
        .outertradehistory{ /* 交易紀錄顯示總外框 */
          width: 500px;
          height: 700px;
          border: 2px solid #ccc; /* 外框的顏色和寬度 */
          position: absolute;
          right: 0;
          margin-right: 20px;
          top: 60%; /* 進度條下方的位置 */
          transform: translateY(-50%);
          
        }
        /* 交易紀錄顯示 */
        .tradehistory{
          width: 450px;
          height: 150px;
          margin-top: 20px;
          margin-left: 25px;
          background-color: aqua;
          display: flex; /* 將內容置於 flexbox 中 */
          align-items: center; /* 垂直置中 */
          justify-content: center; /* 水平置中 */
        }
  </style>

</head>
<body>
<div class="kv w-100">

  <nav class="navbar navbar-expand-lg" style="background-color: #060A1B">
    <div class="container-fluid">
      <a class="navbar-brand" href="#" style="color: #C0C2C6;">
        <img src="./images/logo192.png" alt="" srcset="" class="img-fluid" style="width: 30px;">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse d-flex justify-content-end" id="navbarNavDropdown">
        <ul class="navbar-nav" >
          <li class="nav-item mx-4">
            <a class="nav-link" href="accounting v2.html">記帳</a>
          <li class="nav-item mx-4" >
            <a class="nav-link active" aria-current="page" href="/" style="color: #C0C2C6;">個股</a>
          </li>
          <li class="nav-item mx-4">
            <a class="nav-link" href="#">熱門成交股</a>
          </li>
          <li class="nav-item mx-4">
            <a class="nav-link" href="#">台灣五十股</a>
          </li>
          <li class="nav-item dropdown mx-4">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Dropdown link
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <li><a class="dropdown-item" href="#">Action</a></li>
              <li><a class="dropdown-item" href="#">Another action</a></li>
              <li><a class="dropdown-item" href="#">Something else here</a></li>
            </ul>
          </li>
          <li class="nav-item mx-4" style="border: 1px solid #ffffff;">
            <a class="nav-link text-nowrap d-flex justify-content-center" id="btnb" href="#" style="width: 100px;height: 37px;color: white;">LOG IN</a>
          </li>
          <li class="nav-item mx-4" style="background-color: #424551;">
            <a class="nav-link text-nowrap d-flex justify-content-center" id="btnb" href="#" style="width: 200px;height: 38px;color: white;">CREATE ACCOUNT</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
<div class="account-form">
  <h2 class="totalamounttitle">您的總資產</h2>
  <div class="totalamount">
    <!-- 初始總資產顯示在這裡 -->
    $  <span id="totalAmountDisplay">0.00</span>
  </div>
  <div class="account-form-container">
  <h2>記帳表格</h2>
    <form id="accountForm">
        <label for="date">日期：</label>
        <input type="text" id="date" name="date"><br><br>

        <label for="amount">金額：</label>
        <input type="number" id="amount" name="amount" pattern="[0-9]*" title="請輸入數字" required><br><br>

        <label for="category">類別：</label>
        <select id="category" name="category">
            <option value="飲食">飲食</option>
            <option value="交通">交通</option>
            <option value="娛樂">娛樂</option>
            <!-- 其他類別 -->
        </select><br><br>

        <label for="description">描述/備註：</label><br>
        <textarea id="description" name="description" rows="4" cols="50"></textarea><br><br>

        <label for="payment">支付方式：</label>
        <input type="text" id="payment" name="payment"><br><br>

        <label for="recipient">對象/商家：</label>
        <input type="text" id="recipient" name="recipient"><br><br>

        <input type="radio" id="income" name="type" value="income">
        <label for="income">收入</label>
        <input type="radio" id="expense" name="type" value="expense">
        <label for="expense">支出</label><br><br>

        <input type="submit" value="提交">
    </form>
  </div>
</div>
<!-- 以下為進度條 -->
<div class="progress-container">
  <button class="progress-button" onclick="setLimit()">設定上限</button>
  <!-- 左下方顯示目前的總資產數字 -->
  <div id="currentTotal" class="progress-label"></div>
  <!-- 右下方顯示目前設定的上限數字 -->
  <div id="limitAmount" class="progress-label"></div>
  <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
  </div>
</div>

<div class="outertradehistory">
  <div class="tradehistory"></div>
</div>

<script>
flatpickr("#date", {
// 在此處設置 Flatpickr 的選項（可選）
});
// 獲取表單元素
const form = document.getElementById('accountForm');
// 獲取顯示總資產的元素
const totalAmountDisplay = document.querySelector('.totalamount');
const progressBar = document.getElementById('progressFill');
// 獲取 .tradehistory 元素
const tradeHistoryElement = document.querySelector('.tradehistory');
const previousTradeHistoryElement = document.querySelector('.previous-trade-history');

// 初始總資產
let totalAmount = 0;
let limit = 3000; // 預設上限

// 監聽表單提交事件
form.addEventListener('submit', function(event) {
    event.preventDefault(); // 阻止默認表單提交行為

    // 獲取表單中的金額和收入/支出選擇
    const dateInput = document.getElementById('date');
    const formAmountInput = document.getElementById('amount'); // 修改為 formAmountInput
    const formAmount = parseFloat(formAmountInput.value); // 修改為 formAmount
    const type = document.querySelector('input[name="type"]:checked').value;

    // 檢查日期是否已選擇
    if (!dateInput.value) {
        alert('請選擇日期');
        return;
    }

    // 檢查金額是否為空或者是否包含非數字字符
    if (isNaN(formAmount) || formAmount <= 0) {
        alert('金額欄位請輸入正數');
        return;
    }

    // 根據收入/支出選擇更新總資產
    if (type === 'income') {
        totalAmount += formAmount; // 修改為 formAmount
    } else if (type === 'expense') {
        totalAmount -= formAmount; // 修改為 formAmount
    }

    // 更新總資產顯示
    updateTotalAmount(); // 更新目前總資產數字
    totalAmountDisplay.textContent ='$' + totalAmount.toFixed(2); // 顯示到小數點後兩位

    // 獲取表單中的日期、金額和類別值
    const date = dateInput.value;
    const amount = formAmountInput.value; // 修改為 formAmountInput
    const category = document.getElementById('category').value;

    // 創建一個新的 div 元素來顯示交易記錄
    const transactionElement = document.createElement('div');

    // 根據收入/支出類型設置金額的正負值
    const amountSign = type === 'income' ? '+' : '-';

    // 設置交易記錄的內容，按照指定格式顯示日期、金額和類別
    transactionElement.textContent = `${date}  ${amountSign}${amount} ${category}`;

    // 將交易記錄添加到 .tradehistory 元素中
    tradeHistoryElement.innerHTML = ''; // 清空之前的交易紀錄
    tradeHistoryElement.appendChild(transactionElement);

    // 將之前的交易紀錄移到另一個 div 中
    const previousTransactionElement = document.createElement('div');
    previousTransactionElement.textContent = tradeHistoryElement.innerHTML; // 將之前的交易紀錄內容複製到新的元素中
    previousTradeHistoryElement.innerHTML = ''; // 清空之前的內容
    previousTradeHistoryElement.appendChild(previousTransactionElement);

    // 清空表單欄位
    form.reset();

    updateProgressBar();

});


    function setLimit() {
        const newLimit = prompt('請輸入新的上限');
        if (!isNaN(newLimit) && newLimit > 0) {
            limit = parseFloat(newLimit);
            updateLimitAmount(); // 更新上限數字
            updateProgressBar(); // 更新進度條
        } else {
            alert('請輸入正確的數字');
        }
    }

    updateTotalAmount(); // 顯示目前的總資產數字
    updateLimitAmount(); // 顯示設定的上限數字

    function updateTotalAmount() {
        const currentTotalElement = document.getElementById('currentTotal');
        currentTotalElement.textContent = '目前總資產：$' + totalAmount.toFixed(2);
    }

    function updateLimitAmount() {
        const limitAmountElement = document.getElementById('limitAmount');
        limitAmountElement.textContent = '上限：$' + limit.toFixed(2);
    }

    function updateProgressBar() {
        const progress = Math.min((totalAmount / limit) * 100, 100);
        progressBar.style.width = progress + '%';
        if (totalAmount <= 0) {
            progressBar.style.backgroundColor = 'transparent'; // 無顏色填充
        } else {
            if (progress <= 100) {
                progressBar.style.backgroundColor = '#3498db'; // 淺藍色
            }   
    }
    }

    
  </script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>